generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model admin_profiles {
  id        String   @id
  userId    String   @unique
  createdAt DateTime @default(now())
  users     users    @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model customer_profiles {
  id                    String              @id
  userId                String              @unique
  fatherName            String?
  presentAddress        String?
  permanentAddress      String?
  nidNumber             String?
  nidFrontImageUrl      String?
  nidBackImageUrl       String?
  homeAddress           String?
  governmentIdType      String?
  governmentIdLast4     String?
  dateOfBirth           DateTime?
  emergencyContactName  String?
  emergencyContactPhone String?
  verificationStatus    String              @default("pending")
  rejectionReason       String?
  isVerified            Boolean             @default(false)
  createdAt             DateTime            @default(now())
  updatedAt             DateTime
  isSuspended           Boolean             @default(false)
  suspendedAt           DateTime?
  suspensionReason      String?
  district              String?
  fullName              String?
  nidEncrypted          String?
  phoneNumber           String?
  postOffice            String?
  thana                 String?
  village               String?
  users                 users               @relation(fields: [userId], references: [id], onDelete: Cascade)
  deliveries            deliveries[]
  driver_complaints     driver_complaints[]
  food_orders           food_orders[]
  rides                 rides[]
}

model deliveries {
  id                String            @id
  customerId        String
  driverId          String?
  pickupAddress     String
  pickupLat         Float?
  pickupLng         Float?
  dropoffAddress    String
  dropoffLat        Float?
  dropoffLng        Float?
  serviceFare       Decimal           @db.Decimal(10, 2)
  safegoCommission  Decimal           @db.Decimal(10, 2)
  driverPayout      Decimal           @db.Decimal(10, 2)
  paymentMethod     String
  status            String
  customerRating    Int?
  customerFeedback  String?
  createdAt         DateTime          @default(now())
  updatedAt         DateTime
  deliveredAt       DateTime?
  customer_profiles customer_profiles @relation(fields: [customerId], references: [id])
  driver_profiles   driver_profiles?  @relation(fields: [driverId], references: [id])
}

model driver_complaints {
  id                  String               @id
  driverId            String?
  customerId          String?
  rideId              String?
  reason              String
  description         String?
  status              String               @default("open")
  resolvedAt          DateTime?
  resolvedBy          String?
  createdAt           DateTime             @default(now())
  updatedAt           DateTime
  restaurantId        String?
  type                String               @default("driver")
  customer_profiles   customer_profiles?   @relation(fields: [customerId], references: [id])
  driver_profiles     driver_profiles?     @relation(fields: [driverId], references: [id], onDelete: Cascade)
  restaurant_profiles restaurant_profiles? @relation(fields: [restaurantId], references: [id], onDelete: Cascade)
  rides               rides?               @relation(fields: [rideId], references: [id])
}

model driver_profiles {
  id                    String              @id
  userId                String              @unique
  fatherName            String?
  presentAddress        String?
  permanentAddress      String?
  nidNumber             String?
  nidFrontImageUrl      String?
  nidBackImageUrl       String?
  homeAddress           String?
  governmentIdType      String?
  governmentIdLast4     String?
  driverLicenseNumber   String?
  driverLicenseImageUrl String?
  driverLicenseExpiry   DateTime?
  ssnLast4              String?
  dateOfBirth           DateTime?
  emergencyContactName  String?
  emergencyContactPhone String?
  verificationStatus    String              @default("pending")
  rejectionReason       String?
  isVerified            Boolean             @default(false)
  createdAt             DateTime            @default(now())
  updatedAt             DateTime
  isSuspended           Boolean             @default(false)
  lastActive            DateTime?
  suspendedAt           DateTime?
  suspensionReason      String?
  district              String?
  fullName              String?
  nidEncrypted          String?
  phoneNumber           String?
  postOffice            String?
  thana                 String?
  village               String?
  backgroundCheckDate   DateTime?
  backgroundCheckStatus String?             @default("pending")
  licenseStateIssued    String?
  ssnEncrypted          String?
  usaCity               String?
  usaFullLegalName      String?
  usaPhoneNumber        String?
  usaState              String?
  usaStreet             String?
  usaZipCode            String?
  dmvLicenseImageUrl    String?
  firstName             String?
  lastName              String?
  middleName            String?
  profilePhotoUrl       String?
  tlcLicenseImageUrl    String?
  deliveries            deliveries[]
  driver_complaints     driver_complaints[]
  users                 users               @relation(fields: [userId], references: [id], onDelete: Cascade)
  driver_stats          driver_stats?
  driver_wallets        driver_wallets?
  food_orders           food_orders[]
  rides                 rides[]
  vehicle_documents     vehicle_documents[]
  vehicles              vehicles?
}

model driver_stats {
  id              String          @id
  driverId        String          @unique
  rating          Decimal         @default(5.0) @db.Decimal(3, 2)
  totalTrips      Int             @default(0)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  driver_profiles driver_profiles @relation(fields: [driverId], references: [id], onDelete: Cascade)
}

model driver_wallets {
  id              String          @id
  driverId        String          @unique
  balance         Decimal         @default(0) @db.Decimal(10, 2)
  negativeBalance Decimal         @default(0) @db.Decimal(10, 2)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  driver_profiles driver_profiles @relation(fields: [driverId], references: [id], onDelete: Cascade)
}

model food_orders {
  id                  String              @id
  customerId          String
  restaurantId        String
  driverId            String?
  deliveryAddress     String
  deliveryLat         Float?
  deliveryLng         Float?
  serviceFare         Decimal             @db.Decimal(10, 2)
  safegoCommission    Decimal             @db.Decimal(10, 2)
  restaurantPayout    Decimal             @db.Decimal(10, 2)
  driverPayout        Decimal             @db.Decimal(10, 2)
  paymentMethod       String
  status              String
  customerRating      Int?
  customerFeedback    String?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  deliveredAt         DateTime?
  customer_profiles   customer_profiles   @relation(fields: [customerId], references: [id])
  driver_profiles     driver_profiles?    @relation(fields: [driverId], references: [id])
  restaurant_profiles restaurant_profiles @relation(fields: [restaurantId], references: [id])
}

model notifications {
  id        String   @id
  userId    String
  type      String
  title     String
  body      String
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
  users     users    @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model restaurant_profiles {
  id                 String              @id
  userId             String              @unique
  restaurantName     String
  address            String
  verificationStatus String              @default("pending")
  rejectionReason    String?
  isVerified         Boolean             @default(false)
  createdAt          DateTime            @default(now())
  updatedAt          DateTime
  isSuspended        Boolean             @default(false)
  suspendedAt        DateTime?
  suspensionReason   String?
  driver_complaints  driver_complaints[]
  food_orders        food_orders[]
  users              users               @relation(fields: [userId], references: [id], onDelete: Cascade)
  restaurant_wallets restaurant_wallets?
}

model restaurant_wallets {
  id                  String              @id
  restaurantId        String              @unique
  balance             Decimal             @default(0) @db.Decimal(10, 2)
  negativeBalance     Decimal             @default(0) @db.Decimal(10, 2)
  createdAt           DateTime            @default(now())
  updatedAt           DateTime
  restaurant_profiles restaurant_profiles @relation(fields: [restaurantId], references: [id], onDelete: Cascade)
}

model rides {
  id                String              @id
  customerId        String
  driverId          String?
  pickupAddress     String
  pickupLat         Float?
  pickupLng         Float?
  dropoffAddress    String
  dropoffLat        Float?
  dropoffLng        Float?
  serviceFare       Decimal             @db.Decimal(10, 2)
  safegoCommission  Decimal             @db.Decimal(10, 2)
  driverPayout      Decimal             @db.Decimal(10, 2)
  paymentMethod     String
  status            String
  customerRating    Int?
  customerFeedback  String?
  driverRating      Int?
  driverFeedback    String?
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  completedAt       DateTime?
  driver_complaints driver_complaints[]
  customer_profiles customer_profiles   @relation(fields: [customerId], references: [id])
  driver_profiles   driver_profiles?    @relation(fields: [driverId], references: [id])
}

model users {
  id                  String               @id
  email               String               @unique
  passwordHash        String
  role                String
  countryCode         String
  isBlocked           Boolean              @default(false)
  createdAt           DateTime             @default(now())
  updatedAt           DateTime
  admin_profiles      admin_profiles?
  customer_profiles   customer_profiles?
  driver_profiles     driver_profiles?
  notifications       notifications[]
  restaurant_profiles restaurant_profiles?
}

model vehicle_documents {
  id              String          @id
  driverId        String
  documentType    String
  uploadedAt      DateTime        @default(now())
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  description     String?
  expiresAt       DateTime?
  fileUrl         String
  vehicleId       String?
  driver_profiles driver_profiles @relation(fields: [driverId], references: [id], onDelete: Cascade)
  vehicles        vehicles?       @relation(fields: [vehicleId], references: [id])

  @@index([driverId])
  @@index([vehicleId])
}

model vehicles {
  id                String              @id
  driverId          String              @unique
  vehicleType       String
  vehicleModel      String
  vehiclePlate      String
  isOnline          Boolean             @default(false)
  totalEarnings     Decimal             @default(0) @db.Decimal(10, 2)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  notes             String?
  vehicle_documents vehicle_documents[]
  driver_profiles   driver_profiles     @relation(fields: [driverId], references: [id], onDelete: Cascade)
}
