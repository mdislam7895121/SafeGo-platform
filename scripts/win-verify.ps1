# SafeGo Railway Deployment Verification - win-verify.ps1$ErrorActionPreference = "Stop"Write-Host "SafeGo Railway Verification" -ForegroundColor Cyan# STEP 1: CleanWrite-Host "`n[1] Cleanup..." -ForegroundColor Yellow& ".\scripts\win-clean.ps1"# STEP 2: InstallWrite-Host "`n[2] Installing (npm ci)..." -ForegroundColor Yellownpm ci 2>&1 | Select-Object -Last 2if ($LASTEXITCODE -ne 0) { Write-Host "FAIL: npm ci" -ForegroundColor Red; exit 1 }Write-Host "PASS: npm ci" -ForegroundColor Green# STEP 3: BuildWrite-Host "`n[3] Building (npm run build)..." -ForegroundColor Yellownpm run build 2>&1 | Select-Object -Last 3if (!(Test-Path ".\dist\server\index.js")) { Write-Host "FAIL: dist missing" -ForegroundColor Red; exit 1 }Write-Host "PASS: npm run build" -ForegroundColor Green# STEP 4: Resolve pathsWrite-Host "`n[4] Path aliases (tsc-alias)..." -ForegroundColor Yellownpx tsc-alias -p server/tsconfig.build.json 2>&1 | Out-NullWrite-Host "PASS: Path aliases resolved" -ForegroundColor Green# STEP 5: BootWrite-Host "`n[5] Server boot (no DATABASE_URL)..." -ForegroundColor Yellow$env:JWT_SECRET = "test-secret"Remove-Item Env:DATABASE_URL -ErrorAction SilentlyContinue$env:PORT = "8080"$env:NODE_ENV = "production"$job = Start-Job -ScriptBlock {    Set-Location $using:PWD    $env:JWT_SECRET = "test-secret"    $env:PORT = "8080"    node .\dist\server\index.js 2>&1}Start-Sleep -Seconds 8if ((Get-Job -Id $job.Id).State -eq "Running") {    Write-Host "PASS: Server booted" -ForegroundColor Green} else {    Write-Host "FAIL: Server boot" -ForegroundColor Red    Receive-Job -Job $job 2>&1 | Select-Object -Last 10    exit 1}# STEP 6: Health testsWrite-Host "`n[6] Health endpoints..." -ForegroundColor YellowStart-Sleep -Seconds 1$h1 = curl.exe -s -w "`n%{http_code}" http://localhost:8080/healthz 2>&1 | Select-Object -Last 1$h2 = curl.exe -s -w "`n%{http_code}" http://localhost:8080/health 2>&1 | Select-Object -Last 1$h3 = curl.exe -s -w "`n%{http_code}" http://localhost:8080/api/health 2>&1 | Select-Object -Last 1Write-Host "GET /healthz:    HTTP $h1" -ForegroundColor $(if ($h1 -eq "200") { "Green" } else { "Red" })Write-Host "GET /health:     HTTP $h2" -ForegroundColor $(if ($h2 -eq "200") { "Green" } else { "Red" })Write-Host "GET /api/health: HTTP $h3" -ForegroundColor $(if ($h3 -eq "200") { "Green" } else { "Red" })# CleanupStop-Job -Job $job -ErrorAction SilentlyContinueRemove-Job -Job $job -ErrorAction SilentlyContinue# ResultWrite-Host "`n========================================" -ForegroundColor Cyanif (($h1 -eq "200") -and ($h2 -eq "200") -and ($h3 -eq "200")) {    Write-Host "READY FOR RAILWAY" -ForegroundColor Green    Write-Host "========================================" -ForegroundColor Cyan    Write-Host "`nAll checks PASSED`n" -ForegroundColor Green    exit 0} else {    Write-Host "VERIFICATION FAILED" -ForegroundColor Red    Write-Host "========================================" -ForegroundColor Cyan    exit 1}